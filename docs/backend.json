{
  "entities": {
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a category of business (e.g., food, electronics).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the category."
        },
        "name": {
          "type": "string",
          "description": "Name of the category (e.g., Food, Electronics)."
        },
        "description": {
          "type": "string",
          "description": "A brief description of the category."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Business": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Business",
      "type": "object",
      "description": "Represents a business (producer, wholesaler, distributor, or shopkeeper) listed in the app.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the business."
        },
        "name": {
          "type": "string",
          "description": "Name of the business."
        },
        "businessType": {
          "type": "string",
          "description": "Type of business (e.g., producer, wholesaler, distributor, shopkeeper)."
        },
        "city": {
          "type": "string",
          "description": "City where the business is located."
        },
        "location": {
          "type": "string",
          "description": "Specific location of the business."
        },
        "address": {
          "type": "string",
          "description": "Full address of the business."
        },
        "categoryId": {
          "type": "string",
          "description": "Reference to Category. (Relationship: Category 1:N Business)"
        }
      },
      "required": [
        "id",
        "name",
        "businessType",
        "city",
        "location",
        "address",
        "categoryId"
      ]
    },
    "Product": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Product",
      "type": "object",
      "description": "Represents a product sold by a business.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the product."
        },
        "businessId": {
          "type": "string",
          "description": "Reference to Business. (Relationship: Business 1:N Product)"
        },
        "name": {
          "type": "string",
          "description": "Name of the product."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the product."
        },
        "price": {
          "type": "number",
          "description": "Price of the product."
        },
        "color": {
          "type": "string",
          "description": "Color of the product."
        },
        "weight": {
          "type": "number",
          "description": "Weight of the product."
        },
        "size": {
          "type": "string",
          "description": "Size of the product."
        },
        "manufacturer": {
          "type": "string",
          "description": "Manufacturer of the product."
        },
        "productVarieties": {
          "type": "array",
          "description": "List of product varieties",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "businessId",
        "name",
        "description",
        "price"
      ]
    },
    "Order": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Order",
      "type": "object",
      "description": "Represents an order placed by a guest user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the order."
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N Order)"
        },
        "guestAddress": {
          "type": "string",
          "description": "Delivery address provided by the guest user."
        },
        "transportationCost": {
          "type": "number",
          "description": "Cost of transportation for the order."
        },
        "paymentMethod": {
          "type": "string",
          "description": "Payment method used by the guest user."
        },
        "businessId": {
          "type": "string",
          "description": "Reference to Business. (Relationship: Business 1:N Order)"
        }
      },
      "required": [
        "id",
        "productId",
        "guestAddress",
        "transportationCost",
        "paymentMethod",
        "businessId"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/categories/{categoryId}",
        "definition": {
          "entityName": "category",
          "schema": {
            "$ref": "#/backend/entities/Category"
          },
          "description": "Stores category information. Uses document ID as categoryId.",
          "params": [
            {
              "name": "categoryId",
              "description": "The unique identifier for the category."
            }
          ]
        }
      },
      {
        "path": "/businesses/{businessId}",
        "definition": {
          "entityName": "business",
          "schema": {
            "$ref": "#/backend/entities/Business"
          },
          "description": "Stores business information. Uses document ID as businessId.",
          "params": [
            {
              "name": "businessId",
              "description": "The unique identifier for the business."
            }
          ]
        }
      },
      {
        "path": "/businesses/{businessId}/products/{productId}",
        "definition": {
          "entityName": "product",
          "schema": {
            "$ref": "#/backend/entities/Product"
          },
          "description": "Stores product information for a specific business. Uses document ID as productId.",
          "params": [
            {
              "name": "businessId",
              "description": "The unique identifier for the business."
            },
            {
              "name": "productId",
              "description": "The unique identifier for the product."
            }
          ]
        }
      },
      {
        "path": "/orders/{orderId}",
        "definition": {
          "entityName": "order",
          "schema": {
            "$ref": "#/backend/entities/Order"
          },
          "description": "Stores order information.  Uses document ID as orderId.",
          "params": [
            {
              "name": "orderId",
              "description": "The unique identifier for the order."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support the CityFind application, focusing on businesses listing products and guest users placing orders. Authorization Independence is achieved by avoiding `get()` calls in security rules, relying instead on denormalization. The structure supports the required QAPs through structural segregation and strategic use of path-based ownership.\n\n*   **Authorization Independence:** Achieved primarily through the segregation of data and the path-based ownership model, eliminating the need for complex authorization logic or `get()` calls in security rules.\n*   **QAPs Support:** The structure allows secure `list` operations by ensuring that collections contain documents with homogeneous security requirements.\n\nThe structure ensures that all collections contain data that can be secured consistently, enabling more robust security rules without resorting to complex filtering logic."
  }
}